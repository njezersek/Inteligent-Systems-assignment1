---
title: "Assignment1"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Libraries
```{r}
library(GA)
```

## Population
```{r}
numbers_and_operators <- c("10", "25", "100", "5", "3", "+", "-", "/", "*")
operator_min <- 6
operator_max <- 9
n_numbers <- 5
final_value <- 2512
```

## Generate population
```{r}
generate_agent <- function(object) {
  n <- n_numbers * 2 - 1

  indices <- matrix(NA, nrow = object@popSize, ncol = n)
  for (i in 1:object@popSize) {
    operator_indices <- round(runif(n_numbers - 1, operator_min, operator_max))
    number_indices <- sample(1:n_numbers, n_numbers)
    indices[i, seq(1, n, 2)] <- number_indices
    indices[i, seq(2, n, 2)] <- operator_indices
  }

  return(indices)
}
```

## Fitness function
```{r}
my_fitness <- function(agent) {
  a <- numbers_and_operators[agent]
  val <- eval(parse(text = paste(a, collapse = "")))

  return(abs(val - final_value))
}
```

## Mutation function
```{r}
my_mutation <- function(object, parent) {
  mutate <- parent <- as.vector(object@population[parent, ])
  n <- n_numbers * 2 - 1
  rand <- round(runif(1, 0, 1)) # rand = 0 ali 1
  swap <- seq(1 + rand, n, 2)   # 0 -> (1 3 5 7 9)    1 -> (2 4 6 8)

  indexes <- sample(swap, 2)
  mutate[indexes[1]] <- parent[indexes[2]]
  mutate[indexes[2]] <- parent[indexes[1]]

  return(mutate)
}
```

## Crossover function
```{r}
<<<<<<< HEAD
my_crossover <- function(object, parent) {

=======
crossover <- function(object, parent) {
  object
>>>>>>> 92ffc90d7133ae2b9cd775266497d4e10a84c192
}
```

```{r}
<<<<<<< HEAD
GA <- ga(type = "permutation", population = generate_agent, fitness = my_fitness,
          mutation = my_mutation,
          pcrossover = 0,
          popSize = 10, lower = 1, upper = 9)
```
=======
GA <- ga(type = "permutation", fitness = fitness, mutation = mutation, lower = 1, upper = 9)
# plot(GA)
# summary(GA)
```
>>>>>>> 92ffc90d7133ae2b9cd775266497d4e10a84c192
